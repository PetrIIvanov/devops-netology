<h1>"6.1. Типы и структура СУБД" - Петр Иванов</h1>

## Задача 1

Архитектор ПО решил проконсультироваться у вас, какой тип БД 
лучше выбрать для хранения определенных данных.

Он вам предоставил следующие типы сущностей, которые нужно будет хранить в БД:

- Электронные чеки в json виде  
	~~~
	Я бы распарсил в SQL, полей там конечное количество. Выборки делать удобно. Можно разбить по партициям по времени. 
	В Магните неделя продаж лежит по чекам в базе, остальное уже в виде агрегатов. 
	~~~
	
- Склады и автомобильные дороги для логистической компании
	~~~
	В РЖД лежит в SQL. Дороги хранятся участками пути. К ним привязывается себестоимость. 
	Для анализа можно постороить граф в питоне, например. 
	~~~

- Генеалогические деревья
	~~~
	В одну табличку SQL всех людей. На любую разумную глубину обрабатывается рекурсивным CTE запросом.
	Если нужны горизонтальные связи, между ветками, можно попробовать сетевой базой или объектной.
	~~~
	
	
- Кэш идентификаторов клиентов с ограниченным временем жизни для движка аутенфикации
	~~~
	Никогда не делал. Redis, наверное или Memcache.  
	~~~
	
- Отношения клиент-покупка для интернет-магазина
	~~~
	Задача аналогичная чекам. Если там в личном кабинете нужно именно содержание  
	покупки, то MongoDB
	~~~

Выберите подходящие типы СУБД для каждой сущности и объясните свой выбор.
	~~~
	Тип СУБД определяется не только структурой данных, но и целями обработки в большей степени
	Если надо всё аккуратно записать и потом на уровне учётной системы обрабатывать - это одно. 
	Если надо анализировать и накручивать на данные сверху BI/DS/Whatever это другое.  
	~~~
	
	
## Задача 2

Вы создали распределенное высоконагруженное приложение и хотите классифицировать его согласно 
CAP-теореме. Какой классификации по CAP-теореме соответствует ваша система, если 
(каждый пункт - это отдельная реализация вашей системы и для каждого пункта надо привести классификацию):

- Данные записываются на все узлы с задержкой до часа (асинхронная запись)  
	Availability, но не Consistency

- При сетевых сбоях, система может разделиться на 2 раздельных кластера
	Partition tolerance
	
- Система может не прислать корректный ответ или сбросить соединение
	Это нарушение Availability, Consistency. А вообще плохо так писать, через двойное отрицание. 

А согласно PACELC-теореме, как бы вы классифицировали данные реализации?

	Если все три пункта правда, то это система P. 
	
## Задача 3

Могут ли в одной системе сочетаться принципы BASE и ACID? Почему?

	Нет, потому что BA(SE) противоречит A(CID). Т.е. транзакция может идти бесконечно долгое время, где-то она есть, где-то её нет. 

## Задача 4

Вам дали задачу написать системное решение, основой которого бы послужили:

- фиксация некоторых значений с временем жизни
- реакция на истечение таймаута

Вы слышали о key-value хранилище, которое имеет механизм [Pub/Sub](https://habr.com/ru/post/278237/). 
Что это за система? Какие минусы выбора данной системы?	

	У нас RabbitMQ успешно переносит данные между системами. Плюсы в автономности получателей и отправителей.
	Минусы - если получатель не успевает обрабатывать сообщения пропадают, или падает, сложно проиграть очередь с начала.
	Ещё сложность с удаляемыми объектами. Если добавлять какой-то item или изменять, то это делается через ID. 
	Если удалять - то ID-то у него и нет. Т.е. удалять насовсем объекты нельзя, приходится их невалидное состояние поддерживать у всех систем.   

	